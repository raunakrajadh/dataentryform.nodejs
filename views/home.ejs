<!DOCTYPE html>
<html lang="en" class="no-js">
    <!-- BEGIN HEAD -->
    <head>
        <meta charset="utf-8"/>
        <title>Data Entry</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <meta content="" name="description"/>
        <meta content="" name="author"/>

        <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>

        <!-- GLOBAL MANDATORY STYLES -->
        <link href="http://fonts.googleapis.com/css?family=Hind:300,400,500,600,700" rel="stylesheet" type="text/css">
        <link href="../assets/main/vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css"/>
        <link href="../assets/main/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>

        <!-- PAGE LEVEL PLUGIN STYLES -->
        <link href="../assets/main/css/animate.css" rel="stylesheet">
        <link href="../assets/main/vendor/swiper/css/swiper.min.css" rel="stylesheet" type="text/css"/>

        <!-- THEME STYLES -->
        <link href="../assets/main/css/layout.min.css" rel="stylesheet" type="text/css"/>

        <!-- Favicon -->
        <link rel="icon" href="../assets/images/icon.png"/>
    </head>
    <!-- END HEAD -->

    <style>
        .form-popup {
          display: none;
          border: 3px solid #f1f1f1;
        }
        .form-container {
          width: 100%;
          max-width: 100%;
          padding: 10px;
          background-color: white;
        }
        .form-container input {
          width: 100%;
          padding: 10px;
          margin: 5px 0 22px 0;
          border: none;
          background: #f1f1f1;
        }
        .form-container input:focus {
          background-color: #ddd;
          outline: none;
        }
        .form-container select {
          width: 100%;
          padding: 10px;
          margin: 5px 0 22px 0;
          border: none;
          background: #f1f1f1;
        }
        .form-container select:focus {
          background-color: #ddd;
          outline: none;
        }
        .form-container .btn {
          background-color: #04AA6D;
          color: white;
          border: none;
          cursor: pointer;
          width: 100%;
          margin-bottom:10px;
          opacity: 0.8;
        }
        .form-container .cancel {
          background-color: red;
        }
        .form-container .btn:hover, .open-button:hover {
          opacity: 1;
        }
    </style>

    <% function titleCase(str) { %>
    <%     str = str.toLowerCase(); %>
    <%     str = str.split(' '); %>
    <%     for (var i = 0; i < str.length; i++) { %>
    <%       str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);  %>
    <%     } %>
    <%     return str.join(' '); %>
    <% } %>

    <!-- BODY -->
    <body id="body" data-spy="scroll" data-target=".header">

        <!--========== HEADER ==========-->
        <header class="header navbar-fixed-top">
            <!-- Navbar -->
            <nav class="navbar" role="navigation">
                <div class="container">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="menu-container js_nav-item">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="toggle-icon"></span>
                        </button>

                        <!-- Logo -->
                        <div class="logo">
                            <a class="logo-wrap" href="/">
                                <img class="logo-img" src="../assets/images/icon.png" alt="Asentus Logo">
                            </a>
                        </div>
                        <!-- End Logo -->
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse nav-collapse">
                        <div class="menu-container">
                            <ul class="nav navbar-nav navbar-nav-right">
                                <li class="js_nav-item nav-item"><a class="nav-item-child nav-item-hover" href="/">Home</a></li>
                            </ul>
                        </div>
                    </div>
                    <!-- End Navbar Collapse -->
                </div>
            </nav>
            <!-- Navbar -->

            <!--BACK/FORWARD-->
            <nav role="navigation" style="text-align: right; background-color: white; height: 65px;">
                <div class="container">
                    <br>
                    <div class="buttons">
                        <button onclick="history.back()" class="p-1">
                          <svg height="18px" width="15px" fill="black"  viewBox="0 0 16 13">
                            <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                            <path fill-rule="evenodd" d="M8.354 11.354a.5.5 0 0 0 0-.708L5.707 8l2.647-2.646a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708 0z" />
                            <path fill-rule="evenodd" d="M11.5 8a.5.5 0 0 0-.5-.5H6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 .5-.5z" />
                          </svg>
                        </button>
                        <button onclick="history.forward()" class="p-1">
                          <svg height="18px" width="15px" fill="black"  viewBox="0 0 16 13">
                            <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                            <path fill-rule="evenodd" d="M7.646 11.354a.5.5 0 0 1 0-.708L10.293 8 7.646 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0z" />
                            <path fill-rule="evenodd" d="M4.5 8a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z" />
                          </svg>
                        </button>
                    </div>

                </div>
            </nav>
            <!--BACK/FORWARD-->
        </header>
        <!--========== END HEADER ==========-->
  
        <!--========== PAGE LAYOUT ==========-->

        <!-- Members List -->
        <div id="members">
            <div class="bg-color-sky-light" data-auto-height="true">
                <div class="container content-lg">
                    <div class="row row-space-2 margin-b-4">

                        <div class="row margin-b-40">
                            <div class="col-sm-6">
                                <h2>
                                    <br><br><b>Data Entry Form</b>
                                    <button type="button" class="btn btn-success" onclick="document.getElementById('myForm').style.display = 'block';">New</button>
                                </h2>
                                <button class="btn btn-success" onclick="window.print()">Print</button>
                                <button class="btn btn-success" onclick="ExportToExcel('xlsx')">Download Excel</button>
                            </div>
                        </div>

                        <div class="form-popup" id="myForm">
                            <form class="form-container" id="addStudentForm" method="POST" action="/newRecord">

                                <div>
                                    <div style="width: 555px; display: inline-block;">
                                        <label for="name"><b>Name</b></label>
                                        <input type="text" placeholder="Enter student name" name="name" required>
                                    </div>
                                    
                                    <div style="width: 555px; display: inline-block;">
                                        <label for="address"><b>Address</b></label>
                                        <input type="text" placeholder="Enter address" name="address" required>
                                    </div>
                                </div>
                                <div>
                                    <div style="width: 555px; display: inline-block;">
                                        <label for="contact"><b>Contact Number</b></label>
                                        <input type="text" placeholder="Enter contact number" name="contact" required>
                                    </div>
                                    
                                    <div style="width: 555px; display: inline-block;">
                                        <label for="school"><b>Email</b></label>
                                        <input type="text" placeholder="Enter email address" name="email" required>
                                    </div>
                                </div>
                                

                                <button class="btn" onclick="document.getElementById('addStudentForm').sumbit()">Add</button>
                                <button type="button" class="btn cancel" onclick="document.getElementById('myForm').style.display = 'none';">Close</button>
                            </form>
                        </div>

                        <section class="ftco-section">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="table-wrap">
                                            <table id="studentData" class="table table-striped">
                                                <thead>

                                                    <tr>
                                                        <th>SN.</th>
                                                        <th>Name</th>
                                                        <th>Address</th>
                                                        <th>Contact No</th>
                                                        <th>Email Address</th>
                                                    </tr>

                                                </thead>

                                                <tbody>
                                                    <% if(students.length !== 0){ %>
                                                        <% students.forEach((student) => { %>
                                                            <tr>
                                                                <th scope="row"><%= Number(students.indexOf(student))+1 %></th>
                                                                <td scope="row"><%= student.name %></td>
                                                                <td scope="row"><%= student.address %></td>
                                                                <td scope="req"><%= student.contact %></td>
                                                                <td scope="req"><%= student.email %></td>
                                                            </tr>
                                                           <% }) %>
                                                    <% } %>
                                                </tbody>

                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                    </div>
                </div>
            </div>
        </div>
        <!-- End EMember List -->
            
        <!--========== END PAGE LAYOUT ==========-->


        <!-- JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
        <!-- CORE PLUGINS -->
        <script src="../assets/main/vendor/jquery.min.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/jquery-migrate.min.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>

        <!-- PAGE LEVEL PLUGINS -->
        <script src="../assets/main/vendor/jquery.easing.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/jquery.back-to-top.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/jquery.smooth-scroll.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/jquery.wow.min.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/jquery.parallax.min.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/jquery.appear.js" type="text/javascript"></script>
        <script src="../assets/main/vendor/swiper/js/swiper.jquery.min.js" type="text/javascript"></script>

        <!-- PAGE LEVEL SCRIPTS -->
        <script src="../assets/main/js/layout.min.js" type="text/javascript"></script>
        <script src="../assets/main/js/components/progress-bar.min.js" type="text/javascript"></script>
        <script src="../assets/main/js/components/swiper.min.js" type="text/javascript"></script>
        <script src="../assets/main/js/components/wow.min.js" type="text/javascript"></script>

        <!--TABLE TO EXCEL-->
        <script>
            function ExportToExcel(type, fn, dl) {
                var elt = document.getElementById('studentData');
                var wb = XLSX.utils.table_to_book(elt, { sheet: "Sheet1" });
                return dl ?
                    XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }):
                    XLSX.writeFile(wb, fn || ('Edu Fair.' + (type || 'xlsx')));
            }
        </script>

    </body>
    <!-- END BODY -->
</html>
